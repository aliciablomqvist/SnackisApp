@page "{id:int}"
@model ViewPostModel
@{
    ViewData["Title"] = Model.Post.Title;
}

<h2>@Model.Post.Title</h2>
<p>@Model.Post.Content</p>
@if (!string.IsNullOrEmpty(Model.Post.Image))
{
    <img src="/userImages/@Model.Post.Image" alt="Post image" />
}

<h3>Comments</h3>
@if (Model.Comments != null && Model.Comments.Count > 0)
{
    <ul>
    @foreach (var comment in Model.Comments)
    {
        <li>
            <p>@comment.Content</p>
            <small>@comment.Date</small>
        </li>
    }
    </ul>
}
else
{
    <p>No comments yet.</p>
}

<h3>Add a Comment</h3>
<form method="post">
    <input type="hidden" asp-for="NewComment.PostId" value="@Model.Post.Id" />
    <textarea asp-for="NewComment.Content" cols="40" rows="5"></textarea>
    <input type="submit" class="btn btn-success" value="Add Comment" />
</form>

@if (!ViewData.ModelState.IsValid)
{
    <div class="alert alert-danger">
        <ul>
        @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
        {
            <li>@error.ErrorMessage</li>
        }
        </ul>
    </div>
}
